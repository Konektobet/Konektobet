"use strict";(self.webpackChunkKonektobet=self.webpackChunkKonektobet||[]).push([[6673],{6673:(Q,_,s)=>{s.r(_),s.d(_,{AppointmentModule:()=>N});var d=s(6814),g=s(1896),f=s(5861),x=s(5790),Z=s(3519),m=s.n(Z),t=s(5879),y=s(7344),M=s(7700),A=s(617),C=s(2296),p=s(5195),h=s(9157),v=s(8525),T=s(3680);function O(i,l){if(1&i&&(t.TgZ(0,"mat-option",14),t._uU(1),t.qZA()),2&i){const e=l.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function b(i,l){if(1&i&&(t.TgZ(0,"mat-option",14),t._uU(1),t.qZA()),2&i){const e=l.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function P(i,l){if(1&i&&(t.TgZ(0,"mat-option",14),t._uU(1),t.qZA()),2&i){const e=l.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function q(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",26)(1,"button",27),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.openUpdateAppointment(n.id))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA(),t._uU(4,"Edit "),t.qZA(),t.TgZ(5,"button",28),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.deleteAppointment(n.id))}),t.TgZ(6,"mat-icon"),t._uU(7,"close"),t.qZA(),t._uU(8,"Cancel "),t.qZA()()}}function D(i,l){if(1&i&&(t.TgZ(0,"mat-card",16)(1,"mat-card-header",17)(2,"mat-card-title"),t._uU(3),t.qZA()(),t.TgZ(4,"mat-card-content",18)(5,"div",19)(6,"div",20),t._UZ(7,"img",21),t.qZA(),t.TgZ(8,"div",22)(9,"div",23)(10,"h1"),t._uU(11),t.qZA()(),t.TgZ(12,"div",23)(13,"mat-icon"),t._uU(14,"sentiment_satisfied_alt"),t.qZA(),t.TgZ(15,"h2"),t._uU(16),t.qZA()(),t.TgZ(17,"div",23)(18,"mat-icon"),t._uU(19,"schedule"),t.qZA(),t.TgZ(20,"h2"),t._uU(21),t.qZA()(),t.TgZ(22,"div",23)(23,"mat-icon"),t._uU(24,"date_range"),t.qZA(),t.TgZ(25,"h2"),t._uU(26),t.qZA()(),t.TgZ(27,"div",23)(28,"mat-icon"),t._uU(29,"today"),t.qZA(),t.TgZ(30,"h2",24),t._uU(31),t.qZA()()(),t.YNc(32,q,9,0,"div",25),t.qZA()()()),2&i){const e=l.$implicit,o=t.oxw(2);t.xp6(3),t.hij("",e.aName," Appointment"),t.xp6(1),t.Udp("background-image","url(assets/bg.png)"),t.xp6(7),t.Oqu(e.aName),t.xp6(5),t.Oqu(e.aService),t.xp6(5),t.Oqu(e.aTime),t.xp6(5),t.Oqu(o.formatDate(e.aDate)),t.xp6(4),t.Q6J("ngClass",o.getStatusColorClass(e.status)),t.xp6(1),t.Oqu(e.status),t.xp6(1),t.Q6J("ngIf",o.isAppointmentPending(e.status))}}function U(i,l){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,D,33,10,"mat-card",15),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.filteredAppointments)}}function S(i,l){1&i&&(t.TgZ(0,"div")(1,"div",29),t._UZ(2,"img",30),t.qZA(),t.TgZ(3,"div",31)(4,"h1"),t._uU(5,"No appointments found"),t.qZA(),t.TgZ(6,"h2"),t._uU(7,"Select a status from the dropdown to filter appointments."),t.qZA()()())}const w=[{path:"",component:(()=>{class i{constructor(e,o,n){this.supabaseService=e,this.dialog=o,this.router=n,this.appointments=[],this.filteredAppointments=[],this.selectedStatus="all",this.selectedMonth="all",this.selectedDay="all",this.selectedYear="all",this.uniqueMonths=[],this.uniqueDays=[],this.uniqueYears=[]}ngOnInit(){this.initializeDates(),this.fetchAppointments()}fetchAppointments(){var e=this;return(0,f.Z)(function*(){try{const o=e.supabaseService.getAuthStateSnapshot();if(o){const{data:n,error:a}=yield e.supabaseService.getSupabase().from("users_tbl").select("id").eq("email",o.email);if(a)console.error("Error fetching user data:",a);else if(n&&n.length>0){const r=n[0].id,{data:u,error:c}=yield e.supabaseService.getSupabase().from("appointment_tbl").select("*").eq("aUsers_id",r);c?console.error("Error fetching appointments:",c):(e.appointments=u||[],e.filterAppointments())}else console.error("No user data found for the logged-in user.")}else console.warn("No logged-in user found.")}catch(o){console.error("Error:",o)}})()}initializeDates(){this.uniqueMonths=Array.from({length:12},(e,o)=>new Date(2022,o+1-1,1).toLocaleString("en-US",{month:"long"})),this.uniqueDays=Array.from({length:31},(e,o)=>(o+1).toString()),this.uniqueYears=Array.from({length:28},(e,o)=>(2023+o).toString())}extractUniqueDates(){this.uniqueMonths=Array.from(new Set(this.appointments.map(e=>new Date(e.aDate).toLocaleString("en-US",{month:"long"})))),this.uniqueDays=Array.from(new Set(this.appointments.map(e=>new Date(e.aDate).getDate().toString()))),this.uniqueYears=Array.from(new Set(this.appointments.map(e=>new Date(e.aDate).getFullYear().toString())))}filterAppointments(){console.log("Selected Status:",this.selectedStatus),console.log("Selected Date:",this.selectedMonth,this.selectedDay,this.selectedYear),this.filteredAppointments=this.appointments.filter(e=>{let o=!0,n=!0;if("all"!==this.selectedStatus)switch(this.selectedStatus){case"pending":o="Your appointment status is pending"===e.status;break;case"accepted":o="Your Appointment has been Approved"===e.status;break;case"rejected":o="Your appointment has been Rejected"===e.status;break;default:o=!0}if("all"!==this.selectedMonth||"all"!==this.selectedDay||"all"!==this.selectedYear){const a=new Date(e.aDate),r="all"!==this.selectedMonth?new Date(this.selectedMonth+" 1, 2000").getMonth():void 0,u="all"!==this.selectedDay?parseInt(this.selectedDay):void 0,c="all"!==this.selectedYear?parseInt(this.selectedYear):void 0;void 0!==r&&a.getMonth()!==r&&(n=!1),void 0!==u&&a.getDate()!==u&&(n=!1),void 0!==c&&a.getFullYear()!==c&&(n=!1)}return o&&n})}getStatusColorClass(e){switch(e){case"Your appointment status is pending":return"yellow-status";case"Your Appointment has been approved":return"green-status";case"Your Appointment is Cancelled":return"red-status";default:return""}}openUpdateAppointment(e){this.dialog.open(x.t,{width:"500px",height:"auto",data:{appointmentId:e}}).afterClosed().subscribe(n=>{console.log("The update appointment dialog was closed")})}isAppointmentPending(e){return"Your appointment status is pending"===e}deleteAppointment(e){var o=this;return(0,f.Z)(function*(){try{(yield m().fire({title:"Are you sure?",text:"You will not be able to recover this appointment!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3f51b5",confirmButtonText:"Yes, delete it!"})).isConfirmed&&(yield o.deleteAppointmentFromDatabase(e))}catch(n){console.error("Error deleting appointment:",n),m().fire("Error!","An error occurred while deleting the appointment.","error")}})()}deleteAppointmentFromDatabase(e){var o=this;return(0,f.Z)(function*(){try{yield o.supabaseService.getSupabase().from("appointment_tbl").delete().eq("id",e);const n=o.appointments.findIndex(a=>a.id===e);-1!==n&&o.appointments.splice(n,1),m().fire({icon:"success",title:"Appointment Deleted Successfully",text:"Your appointment has been deleted."}).then(()=>{console.log(e)})}catch(n){console.error("Error deleting appointment:",n),m().fire("Error!","An error occurred while deleting the appointment.","error")}})()}formatDate(e){const o=new Date(e),n=o.getFullYear();return`${o.toLocaleString("en-US",{month:"long"})} ${o.getDate()}, ${n}`}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(y.T),t.Y36(M.uw),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-appointment"]],decls:43,vars:9,consts:[[1,"outer-appointment-container"],[1,"appointments"],[1,"filtering"],[1,"status-filter"],["appearance","outline"],[3,"value","valueChange","selectionChange"],["value","all"],["value","pending"],["value","accepted"],["value","rejected"],[1,"filter"],[3,"value",4,"ngFor","ngForOf"],[1,"inner-appointment-container"],[4,"ngIf"],[3,"value"],["class","appointment-card",4,"ngFor","ngForOf"],[1,"appointment-card"],["color","primary"],[1,"clinic-details"],[1,"details-container"],[1,"details-logo-container"],["src","assets/logo.png","alt","logo.png"],[1,"details-txt-container"],[1,"icons"],[3,"ngClass"],["class","buttons",4,"ngIf"],[1,"buttons"],["mat-raised-button","","color","primary",1,"update-btn",3,"click"],["mat-raised-button","","color","primary",1,"cancel-btn",3,"click"],[1,"no-data"],["src","assets/appointment.svg","alt",""],[1,"no-data-txt"]],template:function(o,n){1&o&&(t.TgZ(0,"body")(1,"div",0)(2,"h1",1),t._uU(3,"Clinic Appointments"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),t._uU(8,"Filter by Status"),t.qZA(),t.TgZ(9,"mat-select",5),t.NdJ("valueChange",function(r){return n.selectedStatus=r})("selectionChange",function(){return n.filterAppointments()}),t.TgZ(10,"mat-option",6),t._uU(11,"All"),t.qZA(),t.TgZ(12,"mat-option",7),t._uU(13,"Pending"),t.qZA(),t.TgZ(14,"mat-option",8),t._uU(15,"Accepted"),t.qZA(),t.TgZ(16,"mat-option",9),t._uU(17,"Rejected"),t.qZA()()()(),t.TgZ(18,"div",10)(19,"mat-form-field",4)(20,"mat-label"),t._uU(21,"Filter by Month"),t.qZA(),t.TgZ(22,"mat-select",5),t.NdJ("valueChange",function(r){return n.selectedMonth=r})("selectionChange",function(){return n.filterAppointments()}),t.TgZ(23,"mat-option",6),t._uU(24,"All"),t.qZA(),t.YNc(25,O,2,2,"mat-option",11),t.qZA()(),t.TgZ(26,"mat-form-field",4)(27,"mat-label"),t._uU(28,"Filter by Day"),t.qZA(),t.TgZ(29,"mat-select",5),t.NdJ("valueChange",function(r){return n.selectedDay=r})("selectionChange",function(){return n.filterAppointments()}),t.TgZ(30,"mat-option",6),t._uU(31,"All"),t.qZA(),t.YNc(32,b,2,2,"mat-option",11),t.qZA()(),t.TgZ(33,"mat-form-field",4)(34,"mat-label"),t._uU(35,"Filter by Year"),t.qZA(),t.TgZ(36,"mat-select",5),t.NdJ("valueChange",function(r){return n.selectedYear=r})("selectionChange",function(){return n.filterAppointments()}),t.TgZ(37,"mat-option",6),t._uU(38,"All"),t.qZA(),t.YNc(39,P,2,2,"mat-option",11),t.qZA()()()(),t.TgZ(40,"div",12),t.YNc(41,U,2,1,"div",13),t.YNc(42,S,8,0,"div",13),t.qZA()()()),2&o&&(t.xp6(9),t.Q6J("value",n.selectedStatus),t.xp6(13),t.Q6J("value",n.selectedMonth),t.xp6(3),t.Q6J("ngForOf",n.uniqueMonths),t.xp6(4),t.Q6J("value",n.selectedDay),t.xp6(3),t.Q6J("ngForOf",n.uniqueDays),t.xp6(4),t.Q6J("value",n.selectedYear),t.xp6(3),t.Q6J("ngForOf",n.uniqueYears),t.xp6(2),t.Q6J("ngIf",n.filteredAppointments&&n.filteredAppointments.length>0),t.xp6(1),t.Q6J("ngIf",!n.filteredAppointments||0===n.filteredAppointments.length))},dependencies:[d.mk,d.sg,d.O5,A.Hw,C.lW,p.a8,p.dn,p.dk,p.n5,h.KE,h.hX,v.gD,T.ey],styles:["body[_ngcontent-%COMP%]{background-color:#fafafa;height:100vh;margin:0}.outer-appointment-container[_ngcontent-%COMP%]{text-align:center;padding:20px}.status-filter[_ngcontent-%COMP%]{margin-bottom:20px}.appointment-card[_ngcontent-%COMP%]{margin-bottom:20px;box-shadow:#00000059 0 5px 15px}.filtering[_ngcontent-%COMP%]{display:flex;justify-content:center}.status-filter[_ngcontent-%COMP%]{margin-right:5rem}.filter[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:20px}.inner-appointment-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.appointments[_ngcontent-%COMP%]{text-align:center;font-size:30px;font-weight:700;margin-top:30px}.appointment-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin-top:3%;max-width:1000px;gap:20px}.make-appointment-container[_ngcontent-%COMP%]{width:100%;border:1px solid #ddd;border-radius:8px;overflow:hidden;box-shadow:0 4px 8px #0000001a}.title[_ngcontent-%COMP%]{background-color:#3f51b5;padding:12px;color:#fff;font-size:1.2rem}mat-card-header[_ngcontent-%COMP%]{display:flex;padding:16px;background-color:#3f51b5;color:#fff;justify-content:center}mat-card-content[_ngcontent-%COMP%]{width:650px}mat-card[_ngcontent-%COMP%]{margin-bottom:20px;box-shadow:#00000059 0 5px 15px}.details-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;padding:12px;flex-direction:column}.details-logo-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:160px;height:auto}.details-txt-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px}.icons[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff}.icons[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:10px}@media screen and (max-width: 769px){mat-card-title[_ngcontent-%COMP%]{font-size:17px}mat-card-content[_ngcontent-%COMP%]{width:auto;height:auto}.icons[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px}.icons[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px}}.icons[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.buttons[_ngcontent-%COMP%]{display:flex;align-items:center}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.no-data[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.no-data[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40%;height:auto}.no-data-txt[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-top:20px}@media screen and (max-width: 769px){.no-data[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:90%;height:auto}.no-data-txt[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px}.no-data-txt[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}}"]})}return i})()}];let Y=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[g.Bz.forChild(w),g.Bz]})}return i})();var F=s(8034),J=s(6223);let N=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[d.ez,Y,A.Ps,C.ot,p.QW,v.LD,h.lN,F.FA,J.u5]})}return i})()}}]);